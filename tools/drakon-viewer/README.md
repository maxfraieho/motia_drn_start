# DRAKON Editor - –ü–æ–≤–Ω–æ—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –†–µ–¥–∞–∫—Ç–æ—Ä –î—ñ–∞–≥—Ä–∞–º

**–í–µ—Ä—Å—ñ—è:** 3.2 (Insertion Socket System)
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ
**–î–∞—Ç–∞:** 2025-10-18
**Live:** https://dangerboys.exodus.pp.ua/

---

## üöÄ –®–≤–∏–¥–∫–∏–π –°—Ç–∞—Ä—Ç

### Production (Live Site)
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π (commit + push + restart nginx)
cd /home/vokov/motia-drn/tools/drakon-viewer
./deploy.sh "Your commit message"

# –ê–±–æ manual –¥–µ–ø–ª–æ–π
docker restart motia_drakon_viewer
```

Live: https://dangerboys.exodus.pp.ua/

### Local Development
```bash
cd /home/vokov/motia-drn/tools/drakon-viewer/public
python3 -m http.server 8080
```

–í—ñ–¥–∫—Ä–∏–π—Ç–µ: http://localhost:8080

### –ü–µ—Ä—à—ñ –ö—Ä–æ–∫–∏

1. **–°—Ç–≤–æ—Ä–∏—Ç–∏ –¥—ñ–∞–≥—Ä–∞–º—É:** `Ctrl+N` ‚Üí –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä—ñ)
2. **–î–æ–¥–∞—Ç–∏ –≤—É–∑–ª–∏:** –ö–ª—ñ–∫ –Ω–∞ —ñ–∫–æ–Ω–∫–∏ –≤ –ø—Ä–∞–≤—ñ–π –ø–∞–Ω–µ–ª—ñ (‚ñ≠ ‚óá ‚ëÇ ‚óè)
3. **–†–µ–¥–∞–≥—É–≤–∞—Ç–∏:** –ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫ –Ω–∞ –≤—É–∑–æ–ª –∞–±–æ Properties Panel
4. **–ó–±–µ—Ä–µ–≥—Ç–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ localStorage –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ
5. **–ï–∫—Å–ø–æ—Ä—Ç:** PNG –∞–±–æ JSON —á–µ—Ä–µ–∑ Properties Panel

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ñ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

‚úÖ **üÜï Insertion Socket System** - –≤—ñ–∑—É–∞–ª—å–Ω—ñ '+' –º–∞—Ä–∫–µ—Ä–∏ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤—É–∑–ª—ñ–≤ –º—ñ–∂ —ñ—Å–Ω—É—é—á–∏–º–∏
‚úÖ **–ü–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥—ñ–∞–≥—Ä–∞–º** - 26 —Ç–∏–ø—ñ–≤ –≤—É–∑–ª—ñ–≤ —É 5 –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö
‚úÖ **Undo/Redo** (—ñ—Å—Ç–æ—Ä—ñ—è –¥–æ 50 —Å—Ç–∞–Ω—ñ–≤)
‚úÖ **Properties Panel** –∑ collapsible –ø–∞–ª—ñ—Ç—Ä–æ—é —ñ–∫–æ–Ω–æ–∫
‚úÖ **LocalStorage** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥—ñ–∞–≥—Ä–∞–º —É –±—Ä–∞—É–∑–µ—Ä—ñ
‚úÖ **–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π Sidebar** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–Ω–æ–∂–∏–Ω–Ω–∏–º–∏ –¥—ñ–∞–≥—Ä–∞–º–∞–º–∏
‚úÖ **File Management** (Open/Save/Export JSON/PNG)
‚úÖ **PNG Export** - –µ–∫—Å–ø–æ—Ä—Ç –¥—ñ–∞–≥—Ä–∞–º —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω—å
‚úÖ **Mobile-First** –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω
‚úÖ **Touch gestures** (pinch-to-zoom, swipe)
‚úÖ **Pan/Zoom** –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è
‚úÖ **State Management** —Å–∏—Å—Ç–µ–º–∞
‚úÖ **Tooltips** –Ω–∞ –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç–∞—Ö (40+)
‚úÖ **Error Handling** - timeout, fallback, recovery buttons  

---

## üéØ –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### Layout
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sidebar ‚îÇ   Canvas     ‚îÇ Properties ‚îÇ
‚îÇ (Left)  ‚îÇ   (Center)   ‚îÇ   Panel    ‚îÇ
‚îÇ         ‚îÇ              ‚îÇ  (Right)   ‚îÇ
‚îÇ –î—ñ–∞–≥—Ä–∞–º–∏‚îÇ  DRAKON      ‚îÇ ‚Ä¢ –Ü–∫–æ–Ω–∫–∏  ‚îÇ
‚îÇ         ‚îÇ  Diagram     ‚îÇ ‚Ä¢ –§–∞–π–ª–∏   ‚îÇ
‚îÇ         ‚îÇ              ‚îÇ ‚Ä¢ –§–æ—Ä–º–∞   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Properties Panel (–ü—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å)

**–ü–∞–ª—ñ—Ç—Ä–∞ —ñ–∫–æ–Ω–æ–∫** (9 —Ç–∏–ø—ñ–≤):
- ‚ñ≠ Action - –î—ñ—è
- ‚óá Question - –ü–∏—Ç–∞–Ω–Ω—è
- ‚ëÇ Branch - –†–æ–∑–≥–∞–ª—É–∂–µ–Ω–Ω—è
- ‚¨° Case - –í–∏–±—ñ—Ä –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤
- ‚¨¢ Address - –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —ñ–Ω—à—É –¥—ñ–∞–≥—Ä–∞–º—É
- ‚¨ì Header - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥—ñ–∞–≥—Ä–∞–º–∏
- ‚•Å Loop Begin - –ü–æ—á–∞—Ç–æ–∫ —Ü–∏–∫–ª—É
- ‚•Ä Loop End - –ö—ñ–Ω–µ—Ü—å —Ü–∏–∫–ª—É
- ‚óè End - –ö—ñ–Ω–µ—Ü—å

**–§–∞–π–ª–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó:**
- üìÑ –ù–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ (`Ctrl+N`)
- üìÇ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª (JSON)
- üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ (`Ctrl+S`)
- üì• –ï–∫—Å–ø–æ—Ä—Ç JSON
- üñºÔ∏è –ï–∫—Å–ø–æ—Ä—Ç PNG

**–í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –≤—É–∑–ª–∞** (–ø—Ä–∏ –≤–∏–±–æ—Ä—ñ):
- ID, Type, Content, Branch ID
- –ö–Ω–æ–ø–∫–∏: –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ / –í–∏–¥–∞–ª–∏—Ç–∏

### Sidebar (–õ—ñ–≤–∞ –ø–∞–Ω–µ–ª—å)

**–ú–æ—ó –¥—ñ–∞–≥—Ä–∞–º–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –¥—ñ–∞–≥—Ä–∞–º
- –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –∑–º—ñ–Ω–∏
- –ö–ª—ñ–∫ –Ω–∞ –¥—ñ–∞–≥—Ä–∞–º—É –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è
- –ö–Ω–æ–ø–∫–∞ üóëÔ∏è –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è (–∑'—è–≤–ª—è—î—Ç—å—Å—è –ø—Ä–∏ hover)
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ localStorage –±—Ä–∞—É–∑–µ—Ä–∞

---

## ‚å®Ô∏è –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω—ñ –°–∫–æ—Ä–æ—á–µ–Ω–Ω—è

### –ó–∞–≥–∞–ª—å–Ω—ñ
- `Ctrl+N` - –ù–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞
- `Ctrl+S` - –ó–±–µ—Ä–µ–≥—Ç–∏
- `Ctrl+0` - Reset zoom
- `ESC` - –ó–∞–∫—Ä–∏—Ç–∏ modal

### –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
- `Ctrl+Z` - Undo
- `Ctrl+Y` - Redo  
- `Delete` - –í–∏–¥–∞–ª–∏—Ç–∏ –≤—É–∑–æ–ª

### –ù–∞–≤—ñ–≥–∞—Ü—ñ—è
- `Ctrl++` / `Ctrl+-` - Zoom
- `Ctrl+Wheel` - Zoom (mouse)
- `Drag` - Pan

---

## üì± Mobile Support

**Touch Gestures:**
- Pinch - Zoom
- 1 –ø–∞–ª–µ—Ü—å - Pan
- Swipe –≤–ø—Ä–∞–≤–æ - –í—ñ–¥–∫—Ä–∏—Ç–∏ sidebar
- 2 –ø–∞–ª—å—Ü—ñ - Pinch-to-zoom

**–ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω:**
- Mobile (< 768px): Overlay panels
- Desktop (‚â• 768px): Static layout

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- [IMPROVEMENTS.md](./IMPROVEMENTS.md) - –§–∞–∑–∞ 1 (Mobile & UX)
- [PHASE2-EDITOR.md](./PHASE2-EDITOR.md) - –§–∞–∑–∞ 2 (Editor Core)
- [PROPERTIES-PANEL.md](./PROPERTIES-PANEL.md) - Properties Panel

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
- `state-manager.js` - –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º
- `drakonwidget.js` - DRAKON rendering engine
- `app.js` - UI controller
- `style.css` - Responsive styles

**Data Flow:**
```
User Action ‚Üí Event Handler ‚Üí State Manager ‚Üí 
  ‚Üí Update UI ‚Üí Reload Diagram ‚Üí Render
```

---

## üõ†Ô∏è Troubleshooting

**–î—ñ–∞–≥—Ä–∞–º–∞ –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è?**
- Ctrl+0 –¥–ª—è reset zoom
- F12 console –¥–ª—è errors
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ JSON —Ñ–æ—Ä–º–∞—Ç

**–ù–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∑–º—ñ–Ω–∏?**
- –£–≤—ñ–º–∫–Ω—ñ—Ç—å edit mode (‚úèÔ∏è)
- Ctrl+S –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è

**Mobile gestures –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å?**
- 2 –ø–∞–ª—å—Ü—ñ –¥–ª—è pinch
- Swipe –∑ –∫—Ä–∞—é –µ–∫—Ä–∞–Ω—É

---

## üìä –§–æ—Ä–º–∞—Ç –î—ñ–∞–≥—Ä–∞–º–∏

```json
{
  "name": "Diagram Name",
  "access": "read|write",
  "items": {
    "1": {
      "type": "action",
      "content": "Text",
      "branchId": 1,
      "one": "2"
    }
  }
}
```

**–¢–∏–ø–∏ –≤—É–∑–ª—ñ–≤:** action, question, branch, case, address, header, loopbegin, loopend, end (9 —Ç–∏–ø—ñ–≤)

---

## üìù Changelog

**v3.2** (2025-10-18) - Insertion Socket System
- üöÄ **NEW:** Insertion Socket System - –≤—ñ–∑—É–∞–ª—å–Ω—ñ '+' –º–∞—Ä–∫–µ—Ä–∏ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤—É–∑–ª—ñ–≤ –º—ñ–∂ —ñ—Å–Ω—É—é—á–∏–º–∏
- üöÄ **NEW:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥—ñ–∞–≥—Ä–∞–º–∏ (Header –∑ –Ω–∞–∑–≤–æ—é ‚Üí End)
- ‚ú® –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—ó —ñ–∫–æ–Ω–∫–∏ –ø—Ä–∏ insertion mode
- ‚ú® ESC –¥–ª—è —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è insertion mode
- ‚ú® Hover –µ—Ñ–µ–∫—Ç–∏ –Ω–∞ insertion sockets (scale 1.2 + glow)
- ‚ú® –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω—å –ø—Ä–∏ –≤—Å—Ç–∞–≤—Ü—ñ (–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ one/two)
- ‚ú® Tooltips –Ω–∞ insertion sockets
- ‚ú® Zoom-aware –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤
- üîß Deploy script –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—é

**v3.1** (2025-10-17) - Bugfix Release
- üêõ **FIX:** Loader timeout (5 —Å–µ–∫) + fallback error
- üêõ **FIX:** Floating button –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è Properties Panel
- üêõ **FIX:** Empty state –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
- ‚ú® –†–æ–∑—à–∏—Ä–µ–Ω–∞ –ø–∞–ª—ñ—Ç—Ä–∞ —ñ–∫–æ–Ω–æ–∫ (6 ‚Üí 9 —Ç–∏–ø—ñ–≤): +Case, +Address, +Header
- ‚ú® Grid –ø–∞–ª—ñ—Ç—Ä–∏ (2 ‚Üí 3 –∫–æ–ª–æ–Ω–∫–∏)
- üîß –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
- üîß UX –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –¥–ª—è –∑–Ω–∏–∫–ª–∏—Ö –ø–∞–Ω–µ–ª–µ–π

**v3.0** (2025-10-17) - LocalStorage & PNG Export Edition
- ‚ú® LocalStorage - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥—ñ–∞–≥—Ä–∞–º —É –±—Ä–∞—É–∑–µ—Ä—ñ
- ‚ú® –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π Sidebar - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–Ω–æ–∂–∏–Ω–Ω–∏–º–∏ –¥—ñ–∞–≥—Ä–∞–º–∞–º–∏
- ‚ú® PNG Export - –µ–∫—Å–ø–æ—Ä—Ç –¥—ñ–∞–≥—Ä–∞–º —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω—å
- ‚ú® Auto-save - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ
- ‚ú® Delete diagrams - –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥—ñ–∞–≥—Ä–∞–º –∑ sidebar
- ‚ú® Tooltips - –ø—ñ–¥–∫–∞–∑–∫–∏ –Ω–∞ –≤—Å—ñ—Ö –∫–Ω–æ–ø–∫–∞—Ö
- üîß –ü–æ–∫—Ä–∞—â–µ–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ localStorage
- üîß –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º

**v2.5** (2025-10-17) - Properties Panel Edition
- Properties Panel –∑ –ø–∞–ª—ñ—Ç—Ä–æ—é
- File Operations
- Node Properties Form

**v2.0** - Full Editor
- State Management
- Undo/Redo
- CRUD Operations

**v1.0** - Mobile & UX
- Touch support
- Responsive design

---

**Project:** Motia DRAKON Viewer  
**Location:** `/home/vokov/motia-drn/tools/drakon-viewer/`  
**Credits:** [drakonwidget](https://github.com/stepan-mitkin/drakonwidget) | [DRAKON Methodology](https://drakon.tech/)
